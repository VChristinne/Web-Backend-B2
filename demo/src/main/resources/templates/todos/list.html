<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
  <title>Task Management</title>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="/webjars/bootstrap/css/bootstrap.min.css"/>
  <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
</head>

<body class="bg-light d-flex flex-column min-vh-100">
<main class="container py-4 flex-grow-1">
  <!-- Alert messages -->
  <div th:replace="~{fragments/alert :: success(${message})}"></div>
  <div th:replace="~{fragments/alert :: error(${error})}"></div>

  <div class="row justify-content-center">
    <div class="col-md-10">
      <h2 class="text-center mb-4 text-primary">Task List</h2>

      <div class="card shadow mb-4">
        <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">All Tasks</h5>
          <a href="/todos/register" class="btn btn-primary">Add New Task</a>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped align-middle mb-0">
              <thead>
              <tr>
                <th>Title</th>
                <th>Responsible</th>
                <th>Due Date</th>
                <th class="text-end">Actions</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="todo : ${todos}">
                <td th:text="${todo.title}"></td>
                <td th:text="${todo.responsible}"></td>
                <td th:text="${#temporals.format(todo.dueDate, 'dd/MM/yyyy')}"></td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-primary" th:href="@{/todos/edit/{id}(id=${todo.id})}" role="button">Edit</a>
                  <button class="btn btn-sm btn-outline-danger"
                          data-bs-toggle="modal"
                          th:data-bs-target="|#delete-modal-${todo.id}|">
                    Delete
                  </button>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="text-center">
        <a href="/" class="btn btn-outline-secondary">Return to home</a>
      </div>
    </div>
  </div>

  <!-- Delete confirmation modals -->
  <div th:each="todo : ${todos}" th:remove="tag">
    <div th:replace="~{fragments/modal :: deleteModal('deleteModal', ${todo.id})}"></div>
  </div>
</main>

<!-- Footer fragment -->
<div th:replace="~{fragments/footer :: copy}"></div>

<!-- Bootstrap JS -->
<script src="/webjars/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>
</html>